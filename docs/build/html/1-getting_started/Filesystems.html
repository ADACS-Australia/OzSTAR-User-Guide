

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>File systems &mdash; OzSTAR User Guide  documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="OzSTAR User Guide  documentation" href="../index.html"/>
        <link rel="next" title="FAQ" href="FAQ.html"/>
        <link rel="prev" title="Swinburne HPC system" href="Swinburne-HPC.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

      
        <!-- a href="../index.html" -->
        <a href="http://136.186.1.220"><!-- target="_blank"-->
      

      
        
        <img src="../_static/OzStar-FA-Mono-KEYLINE.png" class="logo" />
      
      </a>

      

      
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

      
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Index</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Welcome to OzSTAR documentation!</a></li>
</ul>
<p class="caption"><span class="caption-text">Getting Started</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Accounts.html">Accounts</a></li>
<li class="toctree-l1"><a class="reference internal" href="Access.html">Access to the supercomputer</a></li>
<li class="toctree-l1"><a class="reference internal" href="Linux.html">Linux tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="manual.html">How to use man pages</a></li>
<li class="toctree-l1"><a class="reference internal" href="file-transfer.html">File Transfer</a></li>
<li class="toctree-l1"><a class="reference internal" href="Swinburne-HPC.html">Swinburne HPC system</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">File systems</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#directories">Directories</a></li>
<li class="toctree-l2"><a class="reference internal" href="#lustre">Lustre</a></li>
<li class="toctree-l2"><a class="reference internal" href="#dealing-with-lustre">Dealing with Lustre</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#quota">Quota</a></li>
<li class="toctree-l3"><a class="reference internal" href="#optimising-i-o">Optimising I/O</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="FAQ.html">FAQ</a></li>
</ul>
<p class="caption"><span class="caption-text">OzSTAR vs Green II</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../1a-oz_g2/what-s-new.html">What&#8217;s new on OzSTAR?</a></li>
</ul>
<p class="caption"><span class="caption-text">Software</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../2-ozstar/Modules.html">Environment Modules</a></li>
</ul>
<p class="caption"><span class="caption-text">Jobs on OzSTAR</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../2-ozstar/oz-partition.html">Job Queues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2-ozstar/oz-slurm-basics.html">Slurm: basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2-ozstar/oz-slurm-details.html">Slurm: gathering information</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2-ozstar/oz-slurm-create.html">Slurm: Creating a job</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2-ozstar/oz-slurm-examples.html">Slurm: script examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2-ozstar/torque-vs-slurm.html">Torque-Moab vs Slurm</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">OzSTAR User Guide</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>File systems</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="file-systems">
<h1>File systems<a class="headerlink" href="#file-systems" title="Permalink to this headline">¶</a></h1>
<div class="section" id="directories">
<h2>Directories<a class="headerlink" href="#directories" title="Permalink to this headline">¶</a></h2>
<p>On OzSTAR, the two main directories are:</p>
<div class="highlight-rst"><div class="highlight"><pre><span></span>/home

/fred/projects
</pre></div>
</div>
<p>noting that <code class="docutils literal"><span class="pre">/projects</span></code> is soft-linked to <code class="docutils literal"><span class="pre">/fred/projects</span></code>.</p>
<p>Both <code class="docutils literal"><span class="pre">/home</span></code> and <code class="docutils literal"><span class="pre">/projects</span></code> directores are using the Lustre filesystem. The <code class="docutils literal"><span class="pre">/home</span></code> directory is backed up. It has a 10GB quota, and 100,000 files. The <code class="docutils literal"><span class="pre">/projects</span></code> directories are on a lustre filesystem. This is where all of your project data should be stored. There is <strong>NO backup for</strong> <code class="docutils literal"><span class="pre">/projects</span></code> <strong>and the user must take responsibility for backing up any data that is important.</strong></p>
</div>
<div class="section" id="lustre">
<h2>Lustre<a class="headerlink" href="#lustre" title="Permalink to this headline">¶</a></h2>
<p>OzSTAR includes ~5 Petabytes of Lustre-zfs Filesystem for the nodes. The achievable bandwidth into each OSS (Object Storage Server) is approximately 100 Gb/s.</p>
<p>Lustre manuals are at <a class="reference external" href="https://wiki.hpdd.intel.com/display/PUB/Documentation">Intel HPDD Wiki</a></p>
</div>
<div class="section" id="dealing-with-lustre">
<h2>Dealing with Lustre<a class="headerlink" href="#dealing-with-lustre" title="Permalink to this headline">¶</a></h2>
<div class="section" id="quota">
<h3>Quota<a class="headerlink" href="#quota" title="Permalink to this headline">¶</a></h3>
<p>Quotas have been enabled on OzSTAR.</p>
<p>The default quota is 10TB for projects, and 100,000*10 files for projects. If you need extra storage, please contact <a class="reference external" href="mailto:hpc-support&#37;&#52;&#48;swin&#46;edu&#46;au">hpc-support<span>&#64;</span>swin<span>&#46;</span>edu<span>&#46;</span>au</a></p>
<p>To check your quota:</p>
<p><code class="docutils literal"><span class="pre">lfs</span> <span class="pre">quota</span> <span class="pre">/fred</span></code></p>
<p>Output:</p>
<div class="highlight-rst"><div class="highlight"><pre><span></span>[username@pbs ~]$ lfs quota /fred
Disk quotas for usr username (uid 1000):
     Filesystem    kbytes    quota   limit   grace   files   quota   limit   grace
          /fred [1041408]  5242880 6291456       -     [0]       0       0       -
</pre></div>
</div>
<p>(this needs to be done on the head node).</p>
</div>
<div class="section" id="optimising-i-o">
<h3>Optimising I/O<a class="headerlink" href="#optimising-i-o" title="Permalink to this headline">¶</a></h3>
<p>The best way to get good performance to any filesystem (not just Lustre) is to do reads and writes in large chunks and to use large files rather than many small files.</p>
<p>What is “large” in each context? For Lustre, reads and writes of &gt;1MB are ideal. 10 MB and above is best. Small (eg. &lt; 100 kB) reads and writes and especially 4k random writes are a horrible thing to do to any file system and should be avoided if at all possible. They cause a lot of seeking and obtain low i/o performance from the underlying disks. Small sequential reads are often optimised by read-ahead in block devices or Lustre or on the OSTs so may perform ok, but they’re still not a great idea.</p>
<p>Optimal file sizes are usually between 10 MB and 100 GB. Using anything smaller than 10 MB files risks having its i/o time dominated by open()/close() operations, of which there are a limited amount available to the entire file system. A pathologically bad file usage pattern would be a code that uses 100,000 files, each of &lt;8k in size. This will perform extremely badly on anything except a local SSD in your laptop. It is not a suitable usage model for a large shared supercomputer file system. Similarly, writing a code that has open()/close() in a tight inner loop will be completely dominated by the metadata operations to the Lustre MDS, will perform terribly, and will also impact the use of the cluster for all users because the MDS is a shared resource and can only do a finite number of operations per second.</p>
<p>The best way to get high I/O performance when reading or writing lots of data (eg. a checkpoint) from a large parallel code is generally to write one large O(GB) file per process, or if the number of processes is very large, then one file per node. This will send I/O to all or many of the OSTs that make up the filesystem and so could run as fast as 30 GB/s.</p>
<p>File lock bouncing is also an issue that can affect POSIX parallel file systems. This typically occurs when multiple nodes are appending to the same shared “log” file. However by its very nature the contents of the file are undefined, so it is really a “junk” file. However Lustre will valiantly attempt to interlace I/O from each appending node at the exact moment it writes, leading to a vast amount of “write lock bouncing” between all the appending nodes. This kills the performance all the processes appending, from the nodes doing the appending, and (worst of all) increases the load on the MDS greatly. Do not append to any shared files from multiple nodes. Do not write to any shared files from multiple nodes unless you are going via a library like MPI IO.</p>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="FAQ.html" class="btn btn-neutral float-right" title="FAQ" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Swinburne-HPC.html" class="btn btn-neutral" title="Swinburne HPC system" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
    
      <style>
        /* Sidebar header (and topbar for mobile) */
        .wy-side-nav-search, .wy-nav-top {
          background: #000000;
        }
        /* Sidebar */
        /*.wy-nav-side {*/
          /*background: #ff0000;*/
        /*}*/
      </style>
    

</body>
</html>